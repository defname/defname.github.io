import{d as C,x as T,aj as z,o as t,c as G,w as c,b as h,j as i,f as s,k,H as I,J as $,K as B,a as n,t as o,g as l,l as p,R as _,F as a,G as F}from"./index-3ZK49mb_.js";import{b as A,u as R}from"./riskassessment-KgugIp1H.js";import{G as S}from"./GenericEditModal-Dppvnbx2.js";import{S as f}from"./helpers-uuFYflK0.js";import{T as V}from"./TemplateRiskAssessmentPage-nIax4Xsq.js";import{S as N}from"./SignatureInput-wS4DDK5r.js";import"./livequery-VOXpod5w.js";import"./liveriskstree-CNrmgGWA.js";import"./index-_L_1tPAP.js";function P(E){const{exportData:b,updateExportData:r}=A(E);return{open:async()=>{await r(),console.log("FOOO")}}}const j={id:"print"},O=n("h1",null,"Einsatzplanung",-1),U=n("p",null," Es wird grundsätzlich nach den geltenden Regeln und Vorschriften der DGUV, dem Arbeitsschutzgesetz, der BetrSichV, den TRBS und der FISAT FSR-SZP gearbeitet. ",-1),W=n("strong",null,"Ausführende Firma:",-1),Z=n("strong",null,"Einsatzdatum:",-1),q=n("strong",null,"Einsatzort:",-1),J=n("strong",null,"Durchzuführende Arbeiten:",-1),K=n("br",null,null,-1),Q={key:0},X=n("strong",null,"Aufsichtsführende Höhenarbeiter:",-1),Y=n("p",null,[n("strong",null,"Höhenarbeiter:")],-1),nn=n("thead",null,[n("tr",null,[n("th",null,"Name"),n("th",null,"FISAT-Nr"),n("th",null,"Level")])],-1),en=n("strong",null,"Ausrüstung:",-1),tn=n("h2",null,"Zugangsverfahren",-1),sn={key:0},ln=n("strong",null,"Einstieg:",-1),rn=["innerHTML"],un={key:1},on=n("strong",null,"Ausstieg:",-1),an=["innerHTML"],dn={key:2},cn=n("strong",null,"Anschlagpunkte:",-1),hn=["innerHTML"],_n=["innerHTML"],pn=n("h2",null,"Notfall- und Rettungsplan",-1),mn=["innerHTML"],gn=n("h1",null,"Gefährdungsermittlung",-1),fn={key:0},kn={key:1},bn={key:2},yn=n("thead",null,[n("tr",null,[n("th",null,"Gefährdung"),n("th",null,"Maßnahme")])],-1),vn={colspan:"2"},En={class:"factor"},Tn={key:0},An=["src"],Dn={key:2},Hn=n("strong",null,"Ohne Unterschrift",-1),Mn=[Hn],xn=n("h1",null,"Empfangsbestätigung",-1),Ln=n("p",null," Es wird bestätigt, über Gefahren und Maßnahmen aufgeklärt worden zu sein. ",-1),wn=["src"],Vn=C({__name:"RiskAssessmentExport",setup(E){const b=R(),{exportData:r,updateExportData:y}=A(),{open:D}=P(),H=T(void 0),v=T(!1);function M(g){const u=window.open("","print","");if(!u)return;u.open(),u.document.write('<html>\n    <head>\n        <link rel="stylesheet" href="/ra/print.css" />\n    </head>\n    <body>'.concat(g.outerHTML,"\n    </body>\n    </html>")),u.document.close();const e=u.document.createElement("script");e.setAttribute("src","/ra/print.js"),u.document.head.appendChild(e)}async function x(){M(document.getElementById("print"))}function L(g){b.signature=g,y()}return z(()=>{y()}),(g,u)=>(t(),G(V,null,{default:c(()=>[h(s(k),{"router-link":"/riskassessment/"+s(b).id+"/sign"},{default:c(()=>[i("Unterzeichnen (Technicker)")]),_:1},8,["router-link"]),h(s(k),{onClick:u[0]||(u[0]=e=>v.value=!0)},{default:c(()=>[i("Unterzeichnen")]),_:1}),h(s(k),{onClick:u[1]||(u[1]=e=>x())},{default:c(()=>[i("Drucken")]),_:1}),h(s(k),{onClick:u[2]||(u[2]=e=>s(D)())},{default:c(()=>[i("PDF")]),_:1}),h(S,{"is-open":v.value,"hide-save":"",onWillDismiss:u[3]||(u[3]=e=>v.value=!1),onDidPresent:u[4]||(u[4]=e=>g.$refs.signatureinput.updateDimensions())},{default:c(()=>[h(N,{onSignature:L,ref_key:"signatureinput",ref:H},null,512)]),_:1},8,["is-open"]),h(s(F),null,{default:c(()=>[h(s(I),null,{default:c(()=>[h(s($),null,{default:c(()=>[i("Druckvorschau")]),_:1})]),_:1}),h(s(B),null,{default:c(()=>[n("div",j,[O,U,n("p",null,[W,i(" "+o(s(r).company),1)]),n("p",null,[Z,i(" "+o(s(r).startDate)+" "+o(s(r).endDate?s(r).endDate:""),1)]),n("p",null,[q,i(" "+o(s(r).address),1)]),n("p",null,[J,K,i(" "+o(s(r).jobDescr),1)]),s(r).supervisors?(t(),l("p",Q,[X,i(" "+o(s(r).supervisors.map(e=>e.name).join(", ")),1)])):p("",!0),Y,n("table",null,[nn,(t(!0),l(a,null,_(s(r).technicians,e=>{var m,d;return t(),l("tr",null,[n("td",null,o(e.name),1),n("td",null,o((m=e.fisat)==null?void 0:m.id),1),n("td",null,o((d=e.fisat)==null?void 0:d.level),1)])}),256))]),n("p",null,[en,n("ul",null,[(t(!0),l(a,null,_(s(r).equipment,e=>(t(),l("li",null,o(e.descr),1))),256))])]),tn,(t(!0),l(a,null,_(s(r).access,e=>(t(),l(a,null,[n("p",null,[n("strong",null,o(e.title),1)]),e.access?(t(),l("p",sn,[ln,i(),n("span",{innerHTML:e.access},null,8,rn)])):p("",!0),e.exit?(t(),l("p",un,[on,i(),n("span",{innerHTML:e.exit},null,8,an)])):p("",!0),e.anchorPoints?(t(),l("p",dn,[cn,i(),n("span",{innerHTML:e.anchorPoints},null,8,hn)])):p("",!0),e.comment?(t(),l("p",{key:3,innerHTML:e.comment},null,8,_n)):p("",!0)],64))),256)),pn,(t(!0),l(a,null,_(s(r).access,e=>(t(),l(a,null,[n("p",null,[n("strong",null,o(e.title),1)]),n("p",{innerHTML:e.rescue},null,8,mn)],64))),256)),gn,(t(!0),l(a,null,_([s(f).Access,s(f).Environment,s(f).Work],e=>(t(),l(a,null,[e===s(f).Access?(t(),l("h3",fn,"Gefahren durch die ausgewählten Zugangstechniken")):e===s(f).Environment?(t(),l("h3",kn,"Gefahren durch die Arbeitsumgebung")):(t(),l("h3",bn,"Gefahren durch die Arbeit")),n("table",null,[yn,n("tbody",null,[(t(!0),l(a,null,_(s(r).categories,m=>(t(),l(a,null,[m.risks.filter(d=>d.risk.sector===e).length?(t(),l(a,{key:0},[n("tr",null,[n("th",vn,o(m.descr),1)]),(t(!0),l(a,null,_(m.risks.filter(d=>d.risk.sector===e),d=>(t(),l("tr",null,[n("td",null,[n("span",En,o(d.risk.factor.descr),1),i(" "+o(d.risk.descr),1)]),n("td",null,[d.measures.length>1?(t(),l("ul",Tn,[(t(!0),l(a,null,_(d.measures,w=>(t(),l("li",null,o(w.descr),1))),256))])):d.measures.length===1?(t(),l(a,{key:1},[i(o(d.measures[0].descr),1)],64)):p("",!0)])]))),256))],64)):p("",!0)],64))),256))])])],64))),256)),s(r).signature?(t(),l("img",{key:1,src:s(r).signature.signature},null,8,An)):(t(),l("p",Dn,Mn)),xn,Ln,(t(!0),l(a,null,_(s(r).signatures,e=>(t(),l("div",null,[n("img",{src:e.signature},null,8,wn)]))),256))])]),_:1})]),_:1})]),_:1}))}});export{Vn as default};
