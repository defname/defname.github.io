import{a as m}from"./riskassessment-yedfBpr3.js";import{p as f}from"../vfs_fonts-TTmJ_5FS.js";import{p as l}from"../../async-vendor-gRlujhSQ.js";import{S as o}from"./database-EV4tUyzx.js";import{s as d,a as h}from"./md2pdfmake-fUz3rk0K.js";l.vfs=f;function c(...t){return t.length===0?0:t.length===1?t[0]*28.3465:t.map(n=>n*28.3465)}function p(t,n){return[{text:"Seite "+t+" von "+n,alignment:"center",margin:[0,5]},{text:["Erstellt am "+new Date(Date.now()).toLocaleDateString("de")+" mit ",{text:"RopeRisk App",bold:!0,italics:!0}],alignment:"center",color:"#AAAAAA"}]}function g(t){return new Date(t).toLocaleDateString("de")}function b(t){return[["Ausführende Firma",t.company],["Datum",g(t.startDate)+(t.endDate?" - "+g(t.endDate):"")],["Einsatzort",t.address],["Durchzuführende Arbeiten",t.jobDescr],["Aufsichtsführender Höhenarbeiter",t.supervisors.map(r=>r.name).join(", ")]].map(r=>({text:[{text:r[0]+": ",style:"caption"},r[1]],style:"p"}))}function y(t){const n=[["entrance","Einstieg"],["exit","Ausstieg"],["anchorPoints","Anschlagpunkte"],["comment",""]],r=(a,s,e)=>({stack:s!==""?[{text:s+": ",bold:!0},{text:[{text:"foo"}],style:"p"},d(a[e])]:d(a[e]),margin:c(.5,.2,0,0),lineHeight:1.2});return t.access.map(a=>[{text:a.title,bold:!0,lineHeight:1.2},...n.filter(s=>a[s[0]]!=="").map(s=>r(a,s[1],s[0]))])}function u(t,n){const r=[[{text:"Gefährdung",style:"tableHeader"},{text:"Maßnahme",style:"tableHeader"}]];return t.categories.forEach(a=>{const s=a.risks.filter(e=>e.risk.sector===n);s.length!==0&&(r.push([{text:a.descr,style:"riskCategory",colSpan:2},{}]),r.push(...s.map(e=>[[{text:e.risk.factor.descr,style:"riskFactor"},e.risk.descr],e.measures.length===0?{text:"Keine Maßnahme vorhanden",style:"noMeasure"}:e.measures.length===1?e.measures[0].descr:{ul:e.measures.map(i=>i.descr)}])))}),{layout:"riskTable",table:{headerRows:1,widths:["*","*"],body:r}}}function L(t){const{exportData:n,updateExportData:r}=m(t);l.tableLayouts={customLayout:{hLineWidth:function(e,i){return e===0||e===i.table.body.length?0:e===i.table.headerRows?.5:0},vLineWidth:function(e){return 0},hLineColor:function(e){return"#aaa"},paddingLeft:function(e){return e===0?0:8},paddingRight:function(e,i){return e===i.table.widths.length-1?0:8}},riskTable:{hLineWidth:()=>.5,vLineWidth:()=>.5,hLineColor:()=>"#aaa",vLineColor:()=>"#aaa"}};const a=()=>({watermark:{text:"RopeRisk App",opacity:.03,bold:!0,italics:!1},pageSize:"A4",pageMargins:c(2.5,2,2.5,3),info:{title:"Baustellenplan/Gefährdungsbeurteilung",author:"TODO",creator:"RopeRisk App",producer:"RopeRisk App",subject:"gefährdungsermittlung"},permissions:{modifying:!1,copying:!1,annotating:!1,documentAssembly:!1},footer:p,content:[{text:"Einsatzplanung",style:"title"},{text:"Es wird grundsätzlich nach den geltenden Regeln und Vorschriften der DGUV, dem Arbeitsschutzgesetz, der BetrSichV, den TRBS und der FISAT FSR-SZP gearbeitet",style:"intro"},b(n),{text:"Höhenarbeiter:",style:["caption","p"]},{layout:"customLayout",table:{headerRows:1,widths:["*","auto","auto"],body:[[{text:"Name",style:"tableHeader"},{text:"FISAT Nr.",style:"tableHeader"},{text:"Level",style:"tableHeader"}],...n.technicians.map(e=>{var i;return[e.name,((i=e.fisat)==null?void 0:i.id)||"",e.fisat?e.fisat.level+"":""]})]},style:"marginBottom"},{text:"Ausrüstung:",style:["caption","p"]},{ul:n.equipment.map(e=>e.descr),style:"ul"},{text:"Zugangsverfahren",style:"subheader"},...y(n),{text:"Notfall- und Rettungsplan",style:"subheader"},...n.access.map(e=>[{text:e.title,bold:!0,lineHeight:1.2},d(e.rescue)]),{text:"Gefährdungsermittlung",style:"header",pageBreak:"before"},{text:"Gefahren durch die ausgewählten Zugangstechniken",style:"subheader"},u(n,o.Access),{text:"Gefahren durch die Arbeitsumgebung",style:"subheader"},u(n,o.Environment),{text:"Gefahren durch die Arbeit",style:"subheader"},u(n,o.Work),n.signature?{image:n.signature.signature,width:c(8)}:"Keine Unterschrift"],styles:{defaultStyle:{},title:{fontSize:22,bold:!0,alignment:"center"},header:{fontSize:18,bold:!0},subheader:{fontSize:14,bold:!0,margin:[0,15,0,5]},intro:{margin:22,lineHeight:1.2},p:{margin:[0,5],lineHeight:1.2},ol:{margin:[10,5],lineHeight:1.2},ul:{margin:[10,5],lineHeight:1.2},marginTop:{margin:[0,5,0,0]},marginBottom:{margin:[0,0,0,5]},caption:{bold:!0},tableHeader:{bold:!0},riskFactor:{fontSize:8},riskCategory:{fontSize:12,bold:!0,italics:!0,alignment:"center"},noMeasure:{italics:!0},...h()},pageBreakBefore:function(e,i,x,k){return!1}});return{open:async()=>{await r(),l.createPdf(a()).open()}}}export{L as u};
