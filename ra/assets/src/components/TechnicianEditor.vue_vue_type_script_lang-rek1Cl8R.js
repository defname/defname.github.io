import{a3 as n,Z as a,b7 as r,b8 as o,b9 as h,b2 as d,b5 as c,ai as m,_ as f,b4 as l,ba as I,bb as u,b3 as b}from"../../vendor-fe-4Mo55.js";import{d as s}from"../composables/database-EV4tUyzx.js";import{p as i}from"../composables/helpers-Kc8KqJcx.js";const w={components:{IonButtons:n,IonInput:a,IonGrid:r,IonRow:o,IonCol:h,IonSelect:d,IonSelectOption:c,IonTextarea:m,IonButton:f,IonCard:l,IonCardHeader:I,IonCardTitle:u,IonCardContent:b},emits:["hasSaved","hasAdded"],props:{technicianId:Number,createNew:Boolean},data(){return{name:"",fisatId:"",comment:"",fisatLevel:"",modified:!1,technicianData:void 0}},methods:{loadFromDb(e){e!==void 0&&s.technicians.get(e).then(t=>{if(t===void 0){i("Es exisitert kein Mitarbeiter mit der ID ".concat(e," in der Datenbank"),"danger");return}this.technicianData=t,this.resetForm(t)}).catch(t=>{console.log(t)})},resetForm(e=void 0){if(e===void 0){this.name="",this.fisatId="",this.fisatLevel="1",this.comment="";return}this.name=e.name,e.fisat?(this.fisatId=e.fisat.id,this.fisatLevel=""+e.fisat.level):(this.fisatId="",this.fisatLevel="1"),this.comment=e.comment?e.comment:""},async saveToDb(){if(this.technicianId===void 0&&!this.createNew)return;let e={name:this.name};if(this.name==="")return i("Es muss ein Name angegeben werden","danger"),!1;if(this.fisatId!==""){let t=parseInt(this.fisatLevel);if(![1,2,3].includes(t))return i("Ungültiges FISAT Level: "+t,"danger"),!1;e.fisat={id:this.fisatId,level:t}}this.comment!==""&&(e.comment=this.comment),this.createNew?s.technicians.add(e).then(t=>(this.modified=!1,i("Angestellter hinzugefügt","success"),this.$emit("hasAdded",{id:t,...e}),!0)).catch(t=>{throw i("Beim Speichern ist ein Fehler aufgetreten","danger"),t}):s.technicians.update(this.technicianId,e).then(()=>(this.modified=!1,i("Änderungen gespeichert","success"),this.$emit("hasSaved",{id:this.technicianId,...e}),!0)).catch(t=>{throw i("Beim Speichern ist ein Fehler aufgetreten","danger"),t})}},mounted(){this.createNew?this.resetForm():this.loadFromDb(this.technicianId)},watch:{createNew(e){e&&this.resetForm()},technicianId(e){this.createNew||this.loadFromDb(e)}}};export{w as _};
