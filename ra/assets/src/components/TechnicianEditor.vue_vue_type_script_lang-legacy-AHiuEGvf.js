System.register(["../../vendor-legacy-1yjrExH1.js","../composables/database-legacy-9fIx2aCc.js","../composables/helpers-legacy-9syT91eV.js"],(function(e,t){"use strict";var i,n,s,a,h,o,r,c,d,m,l,I,f,u,g;return{setters:[e=>{i=e.a3,n=e.Z,s=e.b7,a=e.b8,h=e.b9,o=e.b2,r=e.b5,c=e.ai,d=e._,m=e.b4,l=e.ba,I=e.bb,f=e.b3},e=>{u=e.d},e=>{g=e.p}],execute:function(){e("_",{components:{IonButtons:i,IonInput:n,IonGrid:s,IonRow:a,IonCol:h,IonSelect:o,IonSelectOption:r,IonTextarea:c,IonButton:d,IonCard:m,IonCardHeader:l,IonCardTitle:I,IonCardContent:f},emits:["hasSaved","hasAdded"],props:{technicianId:Number,createNew:Boolean},data:()=>({name:"",fisatId:"",comment:"",fisatLevel:"",modified:!1,technicianData:void 0}),methods:{loadFromDb(e){void 0!==e&&u.technicians.get(e).then((t=>{void 0!==t?(this.technicianData=t,this.resetForm(t)):g(`Es exisitert kein Mitarbeiter mit der ID ${e} in der Datenbank`,"danger")})).catch((e=>{console.log(e)}))},resetForm(e=void 0){if(void 0===e)return this.name="",this.fisatId="",this.fisatLevel="1",void(this.comment="");this.name=e.name,e.fisat?(this.fisatId=e.fisat.id,this.fisatLevel=""+e.fisat.level):(this.fisatId="",this.fisatLevel="1"),this.comment=e.comment?e.comment:""},async saveToDb(){if(void 0===this.technicianId&&!this.createNew)return;let e={name:this.name};if(""===this.name)return g("Es muss ein Name angegeben werden","danger"),!1;if(""!==this.fisatId){let t=parseInt(this.fisatLevel);if(![1,2,3].includes(t))return g("Ungültiges FISAT Level: "+t,"danger"),!1;e.fisat={id:this.fisatId,level:t}}""!==this.comment&&(e.comment=this.comment),this.createNew?u.technicians.add(e).then((t=>(this.modified=!1,g("Angestellter hinzugefügt","success"),this.$emit("hasAdded",{id:t,...e}),!0))).catch((e=>{throw g("Beim Speichern ist ein Fehler aufgetreten","danger"),e})):u.technicians.update(this.technicianId,e).then((()=>(this.modified=!1,g("Änderungen gespeichert","success"),this.$emit("hasSaved",{id:this.technicianId,...e}),!0))).catch((e=>{throw g("Beim Speichern ist ein Fehler aufgetreten","danger"),e}))}},mounted(){this.createNew?this.resetForm():this.loadFromDb(this.technicianId)},watch:{createNew(e){e&&this.resetForm()},technicianId(e){this.createNew||this.loadFromDb(e)}}})}}}));
