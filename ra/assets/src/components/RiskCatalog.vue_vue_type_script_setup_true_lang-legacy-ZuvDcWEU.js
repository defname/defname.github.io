System.register(["../../vendor-legacy-1yjrExH1.js","../composables/database-legacy-9fIx2aCc.js","../composables/riskcatalog-legacy-Sa3DPN9n.js","../composables/helpers-legacy-9syT91eV.js","./Sektor-legacy-kkOPc3S4.js","../composables/liveriskstree-legacy-LprV0t_9.js"],(function(e,l){"use strict";var n,a,t,i,o,s,u,d,c,r,f,k,v,g,h,p,b,m,y,_,w,V,x,C,S,A,j,B,D,F,G,N,E,I,L,O,R,T,$,Q,W,H,J,M,P,U,X,q,z,K,Z;return{setters:[e=>{n=e.y,a=e.t,t=e.x,i=e.C,o=e.J,s=e.F,u=e.u,d=e.aE,c=e.D,r=e.E,f=e.M,k=e.L,v=e.aF,g=e.N,h=e.aG,p=e.W,b=e.T,m=e.aH,y=e.X,_=e.Q,w=e.O,V=e.V,x=e.aI,C=e.aJ,S=e.a9,A=e.ab,j=e.am,B=e.ac,D=e.ad,F=e.aK,G=e.aL,N=e.ae,E=e.aM,I=e.aN,L=e.aO,O=e.aP,R=e.aQ,T=e.aR,$=e.aS,Q=e.aT,W=e.aU,H=e.aV,J=e.aW,M=e.aX},e=>{P=e.d,U=e.S},e=>{X=e.R},e=>{q=e.a,z=e.p},e=>{K=e.S},e=>{Z=e.l}],execute:function(){e("_",n({__name:"RiskCatalog",props:{sector:String,modelValue:Array,exclude:Array,inverted:Boolean,linkToFunction:{type:Function,default:e=>`/risks/${e.id}`}},emits:["update:modelValue"],setup(e,{emit:l}){const n=e,Y=l,ee={},le=[{text:"Abbrechen",role:"cancel"},{text:"Speichern",role:"submit"}],ne=Z,ae=a(),te=t((()=>{if(void 0!==ae.value)return ne.get(ae.value)})),ie=t((()=>te.value?te.value.descr:"")),oe={1:I,2:L,3:O,4:R,5:T,6:$,7:Q,8:W,9:H,10:J,11:m};async function se(e){if(void 0===e.id)return;const l={text:"Löschen",role:"destructive",icon:N,handler:(n=e.id,()=>{!async function(e){P.risks.where("id").equals(e).delete().then((()=>{z("Gefährdung wurde aus der Datenbank gelöscht","success")})).catch((e=>{console.log(e)}))}(n)})};var n;null!==ee[e.id]&&ee[e.id].$el.close(),await q(`'${e.descr}' wirklich aus der Datenbank löschen?`,l)}function ue(e){void 0!==e&&void 0!==n.modelValue&&(n.modelValue.includes(e)?Y("update:modelValue",n.modelValue.filter((l=>l!==e))):Y("update:modelValue",[...n.modelValue,e]))}async function de(e){void 0!==ae.value&&(ee[ae.value].$el.close(),"submit"==e.detail.role?(async function(e,l){""!==l?P.risks.update(e,{descr:l}).then((()=>{z("Änderungen gespeichert","success")})).catch((()=>{z("Beim Speichern ist ein Fehler aufgetreten","danger")})):z("Die Beschreibung darf nicht leer sein!","danger")}(ae.value,e.detail.data.values[0]),ae.value=void 0):ae.value=void 0)}return(l,a)=>(i(),o(f,null,[s(u(d),{isOpen:void 0!==ae.value,header:"Beschreibung eingeben",buttons:le,inputs:[{placeholder:"Beschreibung",value:ie.value}],"backdrop-dismiss":!0,onDidDismiss:de},null,8,["isOpen","inputs"]),u(ne)?(i(),c(u(v),{key:0},{default:r((()=>[(i(!0),o(f,null,k(u(ne).categories,(l=>(i(),c(u(h),{key:l.id},{default:r((()=>[s(u(p),{slot:"header"},{default:r((()=>[s(u(b),{slot:"start",icon:l.id?oe[l.id]:u(m)},null,8,["icon"]),s(u(y),null,{default:r((()=>[w(_(l.descr),1)])),_:2},1024)])),_:2},1024),s(u(V),{slot:"content"},{default:r((()=>[(i(!0),o(f,null,k(l.factors,(l=>(i(),c(u(x),{key:l.id},{default:r((()=>[s(u(C),null,{default:r((()=>[s(u(y),null,{default:r((()=>[w(_(l.descr),1)])),_:2},1024),l.id?(i(),c(u(b),{key:0,slot:"end",icon:u(S),color:"primary",onClick:e=>async function(e){if(void 0!==n.sector){const l=n.sector;return P.risks.add(new X("Neue Gefährdung",l,e))}(async()=>{const l=await M.create({header:"Neue Gefährdung",message:"In welchem Sektor besteht die Gefährung?",inputs:[{type:"radio",label:"Zugang",value:U.Access},{type:"radio",label:"Umgebung",value:U.Environment},{type:"radio",label:"Arbeit",value:U.Work}],buttons:[{text:"Abbrechen",role:"cancel"},{text:"Hinzufügen",role:"submit",handler:l=>P.risks.add(new X("Neue Gefährdung",l,e))}]});await l.present()})()}(l.id)},null,8,["icon","onClick"])):g("",!0)])),_:2},1024),(i(!0),o(f,null,k(l.risks,(l=>(i(),o(f,{key:l.id},[void 0!==e.exclude&&e.exclude.includes(l.id)||void 0!==e.modelValue&&e.modelValue.includes(l.id)!==e.inverted||e.sector&&l.sector!==e.sector?g("",!0):(i(),c(u(A),{key:0,ref_for:!0,ref:e=>ee[l.id]=e},{default:r((()=>[s(u(p),{"router-link":e.linkToFunction(l)},{default:r((()=>[s(u(y),null,{default:r((()=>[w(_(l.descr),1)])),_:2},1024),e.sector?g("",!0):(i(),c(u(j),{key:0,slot:"end"},{default:r((()=>[s(K,{sector:l.sector},null,8,["sector"])])),_:2},1024))])),_:2},1032,["router-link"]),void 0!==e.modelValue?(i(),c(u(B),{key:0,side:"start",onIonSwipe:e=>ue(l.id)},{default:r((()=>[e.inverted?(i(),c(u(D),{key:1,color:"warning",onClick:e=>ue(l.id),expandable:""},{default:r((()=>[s(u(b),{icon:u(G),slot:"start"},null,8,["icon"]),w(" Enfernen ")])),_:2},1032,["onClick"])):(i(),c(u(D),{key:0,color:"success",onClick:e=>ue(l.id),expandable:""},{default:r((()=>[s(u(b),{icon:u(F),slot:"start"},null,8,["icon"]),w(" Auswählen ")])),_:2},1032,["onClick"]))])),_:2},1032,["onIonSwipe"])):g("",!0),s(u(B),{side:"end"},{default:r((()=>[s(u(D),{color:"danger",onClick:e=>se(l)},{default:r((()=>[s(u(b),{icon:u(N),slot:"end"},null,8,["icon"]),w(" Löschen ")])),_:2},1032,["onClick"]),s(u(D),{onClick:e=>ae.value=l.id},{default:r((()=>[s(u(b),{icon:u(E),slot:"end"},null,8,["icon"]),w(" Bearbeiten ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1536))],64)))),128))])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1})):g("",!0)],64))}}))}}}));
