import{y as W,t as c,v as F,aZ as H,a_ as O,u as e,C as l,J as u,M as h,F as n,E as i,a$ as g,T as L,b0 as U,b1 as S,S as Z,N as w,P as I,D as k,L as j,b2 as A,O as b,b3 as G,b4 as J,b5 as M,Q as P}from"../../vendor-fe-4Mo55.js";import{i as Q,j as $}from"../../async-vendor-gRlujhSQ.js";import{p as q}from"../composables/helpers-Kc8KqJcx.js";import{S as K}from"../composables/riskassessment-yedfBpr3.js";const R={id:"canvas-outer-wrapper"},X={id:"canvas-inner-wrapper"},Y={key:0,class:"ion-padding"},oe=W({__name:"SignatureInput",props:{techniciansList:{}},emits:["signature"],setup(C,{expose:V,emit:x}){const E=x,z=C;V({updateDimensions:s});const o=c(-1);F(o,()=>{s()});const d=c(void 0),v=c(300),m=c(200),p=c(""),{isSupported:ee,orientation:y}=Q();function s(){v.value=100,m.value=100,setTimeout(()=>{const a=document.getElementById("canvas-inner-wrapper");if(!d||!a)return;let[t,f]=[a.clientWidth,a.clientHeight];v.value=t-20,m.value=f-20,D()},100)}const B=()=>{var t;const r=new Date(Date.now()),a=(t=z.techniciansList)==null?void 0:t.find(f=>f.id===o.value);return a?a.name+", "+r.toLocaleString("de"):r.toLocaleString("de")},_=c({}),D=()=>{_.value={type:"Text",source:B(),x:22,y:22,imageStyle:{},fontStyle:{lineHeight:48,color:"#333333",font:"12px serif",drawType:"fill",textAlign:"left",textBaseline:"top"}}};H(()=>{s(),window.addEventListener("resize",s),window.addEventListener("orientationchange",s)}),O(()=>{window.removeEventListener("resize",s),window.removeEventListener("orientationchange",s)});function T(){s(),d.value.reset()}function N(){E("signature",new K(p.value),o.value!==-1?o.value:void 0),q("Unterschrift hinzugefügt.","success"),d.value.reset()}return(r,a)=>e(y)==="landscape-primary"||e(y)==="landscape-secondary"?(l(),u(h,{key:0},[o.value!==-1||r.techniciansList===void 0?(l(),u(h,{key:0},[n(e(S),{slot:"fixed",horizontal:"start",vertical:"top"},{default:i(()=>[n(e(g),{onClick:T},{default:i(()=>[n(e(L),{icon:e(U)},null,8,["icon"])]),_:1})]),_:1}),n(e(S),{slot:"fixed",horizontal:"end",vertical:"top"},{default:i(()=>[n(e(g),{onClick:N},{default:i(()=>[n(e(g),null,{default:i(()=>[n(e(L),{icon:e(Z)},null,8,["icon"])]),_:1})]),_:1})]),_:1})],64)):w("",!0),I("div",R,[I("div",X,[o.value!==-1||r.techniciansList===void 0?(l(),k(e($),{key:0,image:p.value,"onUpdate:image":a[0]||(a[0]=t=>p.value=t),class:"canvas",ref_key:"canvas",ref:d,width:v.value,watermark:_.value,height:m.value,"background-color":"#ffffff"},null,8,["image","width","watermark","height"])):w("",!0)]),r.techniciansList!==void 0?(l(),u("div",Y,[n(e(A),{interface:"action-sheet",modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=t=>o.value=t),placeholder:"Wer soll unterzeichnen?"},{default:i(()=>[(l(!0),u(h,null,j(r.techniciansList,t=>(l(),k(e(M),{key:t.id,value:t.id},{default:i(()=>[b(P(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])):w("",!0)])],64)):(l(),k(e(J),{key:1},{default:i(()=>[n(e(G),null,{default:i(()=>[b(" Zum unterzeichnen Gerät drehen ")]),_:1})]),_:1}))}});export{oe as _};
