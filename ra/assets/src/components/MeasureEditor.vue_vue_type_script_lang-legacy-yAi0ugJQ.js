System.register(["../../vendor-legacy-1yjrExH1.js","../composables/database-legacy-9fIx2aCc.js","./RiskList.vue_vue_type_script_setup_true_lang-legacy-oeAgQIe8.js","./GenericEditModal-legacy-sKjZkeFq.js","./RiskCatalog.vue_vue_type_script_setup_true_lang-legacy-ZuvDcWEU.js","../composables/helpers-legacy-9syT91eV.js"],(function(e,s){"use strict";var i,t,a,r,d,n,u,o,h,c,l;return{setters:[e=>{i=e.V,t=e.W,a=e.X,r=e.Y,d=e.Z,n=e._},e=>{u=e.d},e=>{o=e._},e=>{h=e.G},e=>{c=e._},e=>{l=e.p}],execute:function(){e("_",{components:{IonList:i,IonItem:t,IonLabel:a,IonListHeader:r,IonInput:d,RiskList:o,RiskCatalog:c,GenericEditModal:h,IonButton:n},emits:["hasSaved","hasAdded"],props:{id:{type:Number},createNew:Boolean,defaultValues:{type:Object,default:{descr:"",solveRisks:[],causeRisks:[]}}},data:()=>({measure:void 0,addSolvedRisks:!1,addCausedRisks:!1}),methods:{loadFromDb(){void 0!==this.id&&u.measures.get(this.id).then((e=>{void 0!==e?this.measure=e:l("Es existiert keine Maßnahme mit der ID "+this.id+" in der Datenbank.","danger")}))},saveToDb(){var e,s;if(""===(null===(e=this.measure)||void 0===e?void 0:e.descr))return void l("Die Beschreibung darf nicht leer sein.");if(0===(null===(s=this.measure)||void 0===s?void 0:s.solveRisks.length))return void l("Eine Maßnahme muss mindestens eine Gefährdung lösen.");if(void 0===this.measure)return void l("Etwas ist schief gelaufen.");const i={descr:this.measure.descr,solveRisks:[...this.measure.solveRisks],causeRisks:[...this.measure.causeRisks]};this.createNew&&u.measures.add(i).then((e=>{l("Die Maßnahme wurde hinzugefügt.","success"),this.$emit("hasAdded",{id:e,...this.measure})})).catch((e=>{throw l("Beim Speichern ist ein Fehler aufgetreten.","danger"),e})),void 0!==this.id?u.measures.update(this.id,i).then((()=>{l("Änderungen gespeichert.","success"),this.$emit("hasSaved",{id:this.id,...this.measure})})).catch((e=>{throw l("Beim Speichern ist ein Fehler aufgetreten.","warning"),e})):l("Ungültige ID","danger")}},mounted(){this.measure=this.defaultValues,console.log(this.measure),this.loadFromDb()}})}}}));
