import{y as I,x as A,bh as S,v as T,C as s,D as o,E as l,F as t,u as e,Y as b,O as a,W as d,T as k,bt as q,N as r,bu as C,bv as L,Z as R,bw as B,bx as P,X as y,J as i,M as u,L as V,by as j,bz as F,Q as _,bA as G,bB as N,V as M}from"../../../../vendor-fe-4Mo55.js";import{u as O,b as Q}from"../../../composables/riskassessment-yedfBpr3.js";import{C as m}from"../../../components/Checkmark-O0xt6YHz.js";import{l as z}from"../../../composables/livequery-P21yeuae.js";import{T as U}from"../../../components/TemplateRiskAssessmentPage-jWM7FwVS.js";import{_ as Z}from"../../../components/HistoryInput.vue_vue_type_script_setup_true_lang-jrOZwH5g.js";import{_ as $}from"../../../components/HistoryTextarea.vue_vue_type_script_setup_true_lang-IIu9Y3E3.js";const H={key:1,class:"nested-list",lines:"none"},J={class:"ion-no-padding ion-no-margin nested-list-item",lines:"none"},W={key:1,class:"nested-list ion-no-padding",lines:"none"},X={class:"ion-no-padding ion-no-margin nested-list-item",lines:"none",size:"small"},ie=I({__name:"RAEditOverview",setup(Y){const v=z.table("technicians"),w=z.table("equipment"),n=O(),D=A(()=>v.isReady().value?n.technicians.map(g=>v.get(g)):[]),x=A(()=>w.isReady().value?n.equipment.map(g=>w.get(g)):[]),f="/riskassessment/"+n.id,E=Q(),h=S({direct:-1,all:-1,solved:-1});return T(E,async()=>{await n.ready,h.direct=n.risks.length;const g=await n.calcAllRisks();h.all=g.length,h.solved=g.filter(p=>n.measures[p]!==void 0&&n.measures[p].length>0).length}),(g,p)=>(s(),o(U,null,{default:l(()=>[t(e(M),{lines:"full"},{default:l(()=>[t(e(b),null,{default:l(()=>[a(" Allgemeines ")]),_:1}),t(e(d),null,{default:l(()=>[t(e(k),{slot:"start",icon:e(q)},null,8,["icon"]),e(n).company?(s(),o(m,{key:0})):r("",!0),t(Z,{modelValue:e(n).company,"onUpdate:modelValue":p[0]||(p[0]=c=>e(n).company=c),"input-id":"ra_company",label:"Ausführende Firma"},null,8,["modelValue"])]),_:1}),t(e(d),null,{default:l(()=>[t(e(k),{slot:"start",icon:e(C)},null,8,["icon"]),e(n).jobDescr?(s(),o(m,{key:0})):r("",!0),t($,{label:"Beschreibung der Tätigkeit","input-id":"ra_jobdescr",modelValue:e(n).jobDescr,"onUpdate:modelValue":p[1]||(p[1]=c=>e(n).jobDescr=c)},null,8,["modelValue"])]),_:1}),t(e(d),null,{default:l(()=>[t(e(k),{slot:"start",icon:e(L)},null,8,["icon"]),e(n).address?(s(),o(m,{key:0})):r("",!0),t(e(R),{"router-link":f+"/location",label:"Addresse","label-placement":"floating",readonly:"",value:e(n).address},null,8,["router-link","value"])]),_:1}),t(e(d),null,{default:l(()=>[t(e(k),{slot:"start",icon:e(B)},null,8,["icon"]),e(n).startDate?(s(),o(m,{key:0})):r("",!0),t(e(R),{"router-link":f+"/date",label:"Datum","label-placement":"floating",readonly:"",value:e(n).startDate+(e(n).endDate?" - "+e(n).endDate:"")},null,8,["router-link","value"])]),_:1}),t(e(d),{"router-link":f+"/equipment",detail:!1},{default:l(()=>[t(e(k),{slot:"start",icon:e(P)},null,8,["icon"]),e(n).equipment?(s(),o(m,{key:0})):r("",!0),t(e(y),{position:"stacked",style:{"z-index":"10"},class:"label"},{default:l(()=>[a("Ausrüstung")]),_:1}),x.value.length>0?(s(),i("ul",H,[(s(!0),i(u,null,V(x.value,c=>(s(),i("li",J,_(c.descr),1))),256))])):r("",!0)]),_:1},8,["router-link"]),t(e(d),{"router-link":f+"/technicians",detail:!1},{default:l(()=>[t(e(k),{slot:"start",icon:e(j)},null,8,["icon"]),e(n).technicians.length>0?(s(),o(m,{key:0})):r("",!0),t(e(y),{position:"stacked",style:{"z-index":"10"},class:"label"},{default:l(()=>[a("Personal")]),_:1}),e(n).technicians.length>0?(s(),i("ul",W,[(s(!0),i(u,null,V(D.value,c=>(s(),i("li",X,_(c.name),1))),256))])):(s(),i(u,{key:2},[a(" Es wurde noch kein Personal ausgewählt ")],64))]),_:1},8,["router-link"]),t(e(b),null,{default:l(()=>[a(" Zugang ")]),_:1}),t(e(d),{"router-link":f+"/access",detail:!1},{default:l(()=>[t(e(k),{slot:"start",icon:e(F)},null,8,["icon"]),e(n).access.length>0?(s(),o(m,{key:0})):r("",!0),t(e(y),{position:"stacked",style:{"z-index":"10"},class:"label"},{default:l(()=>[a("Sektoren")]),_:1}),e(n).access.length===0?(s(),i(u,{key:1},[a("Es wurden noch keine Sektoren definiert")],64)):e(n).access.length===1?(s(),i(u,{key:2},[a("Es wurde ein Sektor definiert")],64)):(s(),i(u,{key:3},[a("Es wurden bisher "+_(e(n).access.length)+" Sektoren definiert",1)],64))]),_:1},8,["router-link"]),t(e(d),{"router-link":f+"/rescue",detail:!1},{default:l(()=>[t(e(k),{slot:"start",icon:e(G)},null,8,["icon"]),e(n).access.length>0?(s(),o(m,{key:0})):r("",!0),t(e(y),{position:"stacked",style:{"z-index":"10"},class:"label"},{default:l(()=>[a("Rettungskonzept")]),_:1}),e(n).access.length===0?(s(),i(u,{key:1},[a("Es wurden noch keine Sektoren definiert")],64)):(s(),i(u,{key:2},[a("Für "+_(e(n).access.filter(c=>c.rescue).length)+" Sektoren existiert ein Rettungskonzept",1)],64))]),_:1},8,["router-link"]),t(e(b),null,{default:l(()=>[a(" Gefährdungen ")]),_:1}),t(e(d),{"router-link":f+"/risks",detail:!1},{default:l(()=>[t(e(k),{slot:"start",icon:e(N)},null,8,["icon"]),e(n).access.length>0?(s(),o(m,{key:0})):r("",!0),t(e(y),{position:"stacked",style:{"z-index":"10"},class:"label"},{default:l(()=>[a("Gefährdungen")]),_:1}),h.all===0?(s(),i(u,{key:1},[a("Es wurden noch keine Gefährdungen hinzugefügt")],64)):(s(),i(u,{key:2},[a(" Von insgesamt "+_(h.all)+" Gefährdungen sind für "+_(h.solved)+" Maßnahmen angegeben. ",1)],64))]),_:1},8,["router-link"])]),_:1})]),_:1}))}});export{ie as _};
