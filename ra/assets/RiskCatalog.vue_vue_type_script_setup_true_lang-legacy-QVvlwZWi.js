System.register(["./index-legacy-La_jvRt6.js","./database-legacy-8-jSFMl0.js","./helpers-legacy-wNo1H66i.js","./liveriskstree-legacy-Mt7epSA0.js"],(function(e,n){"use strict";var t,l,i,a,s,r,o,u,d,c,h,f,g,k,v,p,b,y,m,_,w,x,C,S,V,A,B,j,D,F,G,U,$,I,N,Z,E,O,R,T,W,q,z,L,Y,H,M,P,Q,X,J;return{setters:[e=>{t=e._,l=e.t,i=e.d,a=e.x,s=e.e,r=e.o,o=e.g,u=e.b,d=e.f,c=e.a6,h=e.c,f=e.w,g=e.F,k=e.Y,v=e.aM,p=e.l,b=e.aN,y=e.r,m=e.n,_=e.aO,w=e.i,x=e.j,C=e.I,S=e.aP,V=e.aQ,A=e.aR,B=e.ag,j=e.aC,D=e.ah,F=e.ai,G=e.p,U=e.aS,$=e.ab,I=e.a5,N=e.aT,Z=e.aU,E=e.aV,O=e.aW,R=e.aX,T=e.aY,W=e.aZ,q=e.a_,z=e.a$,L=e.b0,Y=e.b1},e=>{H=e.S,M=e.d,P=e.R},e=>{Q=e.a,X=e.p},e=>{J=e.l}],execute:function(){const n={props:{sector:{type:String,required:!0},short:Boolean},computed:{asString(){return this.sector===H.Access?this.short?"Z":"Zugang":this.sector===H.Environment?this.short?"U":"Umgebung":this.sector===H.Work?this.short?"A":"Arbeit":(console.warn("Unknown sector"),this.short?"?":"???")}}},K=t(n,[["render",function(e,n,t,i,a,s){return l(s.asString)}]]);e("_",i({__name:"RiskCatalog",props:{sector:String,modelValue:Array,exclude:Array,inverted:Boolean,linkToFunction:{type:Function,default:e=>`/risks/${e.id}`}},emits:["update:modelValue"],setup(e,{emit:n}){const t=e,i=n,ee={},ne=[{text:"Abbrechen",role:"cancel"},{text:"Speichern",role:"submit"}],te=J,le=a(),ie=s((()=>{if(void 0!==le.value)return te.get(le.value)})),ae=s((()=>ie.value?ie.value.descr:"")),se={1:N,2:Z,3:E,4:O,5:R,6:T,7:W,8:q,9:z,10:L,11:_};async function re(e){if(void 0===e.id)return;const n={text:"Löschen",role:"destructive",icon:$,handler:(t=e.id,()=>{!async function(e){M.risks.where("id").equals(e).delete().then((()=>{X("Gefährdung wurde aus der Datenbank gelöscht","success")})).catch((e=>{console.log(e)}))}(t)})};var t;null!==ee[e.id]&&ee[e.id].$el.close(),await Q(`'${e.descr}' wirklich aus der Datenbank löschen?`,n)}function oe(e){void 0!==e&&void 0!==t.modelValue&&(t.modelValue.includes(e)?i("update:modelValue",t.modelValue.filter((n=>n!==e))):i("update:modelValue",[...t.modelValue,e]))}async function ue(e){void 0!==le.value&&(ee[le.value].$el.close(),"submit"==e.detail.role?(async function(e,n){""!==n?M.risks.update(e,{descr:n}).then((()=>{X("Änderungen gespeichert","success")})).catch((()=>{X("Beim Speichern ist ein Fehler aufgetreten","danger")})):X("Die Beschreibung darf nicht leer sein!","danger")}(le.value,e.detail.data.values[0]),le.value=void 0):le.value=void 0)}return(n,i)=>(r(),o(g,null,[u(d(c),{isOpen:void 0!==le.value,header:"Beschreibung eingeben",buttons:ne,inputs:[{placeholder:"Beschreibung",value:ae.value}],"backdrop-dismiss":!0,onDidDismiss:ue},null,8,["isOpen","inputs"]),d(te)?(r(),h(d(v),{key:0},{default:f((()=>[(r(!0),o(g,null,k(d(te).categories,(n=>(r(),h(d(b),{key:n.id},{default:f((()=>[u(d(y),{slot:"header"},{default:f((()=>[u(d(m),{slot:"start",icon:n.id?se[n.id]:d(_)},null,8,["icon"]),u(d(w),null,{default:f((()=>[x(l(n.descr),1)])),_:2},1024)])),_:2},1024),u(d(C),{slot:"content"},{default:f((()=>[(r(!0),o(g,null,k(n.factors,(n=>(r(),h(d(S),{key:n.id},{default:f((()=>[u(d(V),null,{default:f((()=>[u(d(w),null,{default:f((()=>[x(l(n.descr),1)])),_:2},1024),n.id?(r(),h(d(m),{key:0,slot:"end",icon:d(A),color:"primary",onClick:e=>async function(e){if(void 0!==t.sector){const n=t.sector;return M.risks.add(new P("Neue Gefährdung",n,e))}(async()=>{const n=await Y.create({header:"Neue Gefährdung",message:"In welchem Sektor besteht die Gefährung?",inputs:[{type:"radio",label:"Zugang",value:H.Access},{type:"radio",label:"Umgebung",value:H.Environment},{type:"radio",label:"Arbeit",value:H.Work}],buttons:[{text:"Abbrechen",role:"cancel"},{text:"Hinzufügen",role:"submit",handler:n=>M.risks.add(new P("Neue Gefährdung",n,e))}]});await n.present()})()}(n.id)},null,8,["icon","onClick"])):p("",!0)])),_:2},1024),(r(!0),o(g,null,k(n.risks,(n=>(r(),o(g,{key:n.id},[void 0!==e.exclude&&e.exclude.includes(n.id)||void 0!==e.modelValue&&e.modelValue.includes(n.id)!==e.inverted||e.sector&&n.sector!==e.sector?p("",!0):(r(),h(d(B),{key:0,ref_for:!0,ref:e=>ee[n.id]=e},{default:f((()=>[u(d(y),{"router-link":e.linkToFunction(n)},{default:f((()=>[u(d(w),null,{default:f((()=>[x(l(n.descr),1)])),_:2},1024),e.sector?p("",!0):(r(),h(d(j),{key:0,slot:"end"},{default:f((()=>[u(K,{sector:n.sector},null,8,["sector"])])),_:2},1024))])),_:2},1032,["router-link"]),void 0!==e.modelValue?(r(),h(d(D),{key:0,side:"start",onIonSwipe:e=>oe(n.id)},{default:f((()=>[e.inverted?(r(),h(d(F),{key:1,color:"warning",onClick:e=>oe(n.id),expandable:""},{default:f((()=>[u(d(m),{icon:d(U),slot:"start"},null,8,["icon"]),x(" Enfernen ")])),_:2},1032,["onClick"])):(r(),h(d(F),{key:0,color:"success",onClick:e=>oe(n.id),expandable:""},{default:f((()=>[u(d(m),{icon:d(G),slot:"start"},null,8,["icon"]),x(" Auswählen ")])),_:2},1032,["onClick"]))])),_:2},1032,["onIonSwipe"])):p("",!0),u(d(D),{side:"end"},{default:f((()=>[u(d(F),{color:"danger",onClick:e=>re(n)},{default:f((()=>[u(d(m),{icon:d($),slot:"end"},null,8,["icon"]),x(" Löschen ")])),_:2},1032,["onClick"]),u(d(F),{onClick:e=>le.value=n.id},{default:f((()=>[u(d(m),{icon:d(I),slot:"end"},null,8,["icon"]),x(" Bearbeiten ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1536))],64)))),128))])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1})):p("",!0)],64))}}))}}}));
