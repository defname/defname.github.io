System.register(["./index-legacy-La_jvRt6.js","./riskassessment-legacy-deVed6iG.js","./livequery-legacy-E6C-7scz.js","./TemplateRiskAssessmentPage-legacy-uUslXcDi.js","./GenericEditModal-legacy-wWD_bCdH.js","./HistoryTextarea.vue_vue_type_script_setup_true_lang-legacy-zmmVFSQx.js","./database-legacy-8-jSFMl0.js","./liveriskstree-legacy-Mt7epSA0.js","./helpers-legacy-wNo1H66i.js","./index-legacy-X91ZUWSc.js","./index-legacy-aZ1iJlQL.js"],(function(e,l){"use strict";var n,a,t,s,i,u,o,d,r,c,m,k,g,f,p,y,_,h,v,b,V,j,w,x,A,C,D,z,E,I,S,P,q,G,R,W,F,M,T,B,H,L,U,$,K,O,N,Y,Z,J,Q,X,ee,le,ne;return{setters:[e=>{n=e.d,a=e.o,t=e.c,s=e.f,i=e.ac,u=e.n,o=e._,d=e.x,r=e.g,c=e.b,m=e.s,k=e.w,g=e.ad,f=e.ae,p=e.k,y=e.af,_=e.I,h=e.F,v=e.Y,b=e.ag,V=e.r,j=e.i,w=e.t,x=e.j,A=e.ah,C=e.ai,D=e.ab,z=e.aj,E=e.e,I=e.ak,S=e.al,P=e.am,q=e.O,G=e.a4,R=e.h,W=e.$,F=e.l,M=e.a0,T=e.a1,B=e.a2,H=e.an,L=e.ao,U=e.ap,$=e.aq,K=e.ar},e=>{O=e.u,N=e.b},e=>{Y=e.u,Z=e.l},e=>{J=e.T},e=>{Q=e.G},e=>{X=e.u,ee=e.a,le=e._},e=>{ne=e.d},null,null,null,null],execute:function(){var l=document.createElement("style");l.textContent=".checkmark[data-v-b74799a7]{float:right}.label[data-v-b50c37a5]{margin-bottom:10px}.nested-list[data-v-b50c37a5]{background:transparent;width:100%;padding:0;margin:0}.nested-list-item[data-v-b50c37a5]{background:transparent;padding:0;margin:0;border:0}\n",document.head.appendChild(l);const ae=o(n({__name:"Checkmark",setup:e=>(e,l)=>(a(),t(s(u),{class:"checkmark",slot:"end",color:"success",icon:s(i)},null,8,["icon"]))}),[["__scopeId","data-v-b74799a7"]]),te=n({__name:"HistoryInput",props:{modelValue:{},label:{},inputId:{}},emits:["update:modelValue"],setup(e,{emit:l}){const n=l,o=e,z=X(o.inputId),E=d(void 0),I=d(!1),S=d(""),{results:P}=ee(S,z.entries,{matchAllWhenSearchEmpty:!0});function q(e){"save"===e.detail.role&&(n("update:modelValue",S.value),z.add(S.value)),I.value=!1}function G(){S.value=o.modelValue}function R(e){S.value=e,E.value.$el.setFocus()}return(e,l)=>(a(),r(h,null,[c(s(m),{label:e.label,"label-placement":"floating",value:e.modelValue,onClick:l[0]||(l[0]=e=>I.value=!0)},null,8,["label","value"]),c(Q,{"is-open":I.value,onWillDismiss:q,onDidPresent:l[4]||(l[4]=e=>E.value.$el.setFocus()),onWillPresent:G,"icon-save":s(i)},{default:k((()=>[c(s(m),{ref_key:"input",ref:E,label:e.label,"label-placement":"stacked",modelValue:S.value,"onUpdate:modelValue":l[2]||(l[2]=e=>S.value=e),onKeydown:l[3]||(l[3]=g(f((e=>R(s(P)[0].item)),["prevent"]),["tab"]))},{default:k((()=>[c(s(p),{slot:"end",fill:"clear",onClick:l[1]||(l[1]=l=>{console.log(S.value,e.modelValue),S.value=e.modelValue})},{default:k((()=>[c(s(u),{slot:"icon-only",icon:s(y)},null,8,["icon"])])),_:1})])),_:1},8,["label","modelValue"]),c(s(_),{ref:"slidingList"},{default:k((()=>[(a(!0),r(h,null,v(s(P),((e,l)=>(a(),t(s(b),{key:e.item,ref_for:!0,ref:"slidingItem"},{default:k((()=>[c(s(V),{onClick:l=>R(e.item)},{default:k((()=>[c(s(j),null,{default:k((()=>[x(w(e.item),1)])),_:2},1024)])),_:2},1032,["onClick"]),c(s(A),{side:"end"},{default:k((()=>[c(s(C),{color:"danger",onClick:l=>{return n=e.item,z.remove(n);var n}},{default:k((()=>[c(s(u),{icon:s(D),slot:"end"},null,8,["icon"]),x(" Löschen ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1},512)])),_:1},8,["is-open","icon-save"])],64))}}),se=n({__name:"AddPresetsModal",setup(e){const l=d(0),n=O(),u=Y(ne.riskassessmentsmeta,(e=>e.where("type").equals("preset").toArray()),!0,[],[l]),o=new Set;function m(e){"save"===e.detail.role&&ne.riskassessments.bulkGet(Array.from(o)).then((e=>{e.forEach((e=>e&&n.mergePreset(e)))}))}return(e,n)=>(a(),t(Q,{title:"Vorlagen auswählen","icon-save":s(i),onWillPresent:n[0]||(n[0]=e=>l.value++),onWillDismiss:m},{default:k((()=>[c(s(_),null,{default:k((()=>[(a(!0),r(h,null,v(s(u),(e=>(a(),t(s(V),{key:e.id},{default:k((()=>[c(s(z),{onIonChange:l=>function(e,l){e.detail.checked?o.add(l):o.delete(l)}(l,e.id),justify:"space-between"},{default:k((()=>[x(w(e.descr),1)])),_:2},1032,["onIonChange"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["icon-save"]))}}),ie={key:1,class:"nested-list",lines:"none"},ue={class:"ion-no-padding ion-no-margin nested-list-item",lines:"none"},oe={key:1,class:"nested-list ion-no-padding",lines:"none"},de={class:"ion-no-padding ion-no-margin nested-list-item",lines:"none",size:"small"};e("default",o(n({__name:"RAEditOverview",setup(e){const l=d(!1),n=Z.table("technicians"),i=Z.table("equipment"),o=O(),g=E((()=>n.isReady().value?o.technicians.map((e=>n.get(e))):[])),f=E((()=>i.isReady().value?o.equipment.map((e=>i.get(e))):[])),y="/riskassessment/"+o.id,b=d(0),A=N(),C=I({direct:-1,all:-1,solved:-1});return S([A],(async()=>{await o.ready,C.direct=o.risks.length;const e=await o.calcAllRisks();C.all=e.length,C.solved=e.filter((e=>void 0!==o.measures[e]&&o.measures[e].length>0)).length})),E((()=>o.changes())),(e,n)=>(a(),t(J,null,{moreButtons:k((()=>[c(s(p),{strong:!0,id:"riskassessment-submenu-button"},{default:k((()=>[c(s(u),{icon:s(P),slot:"icon-only"},null,8,["icon"])])),_:1}),c(s(G),{trigger:"riskassessment-submenu-button","dismiss-on-select":""},{default:k((()=>[c(s(q),null,{default:k((()=>[c(s(_),{lines:"none"},{default:k((()=>[c(s(V),{button:"",onClick:n[0]||(n[0]=e=>l.value=!0)},{default:k((()=>[x(" Vorlage hinzugügen ")])),_:1})])),_:1})])),_:1})])),_:1})])),default:k((()=>[c(se,{"is-open":l.value,onWillDismiss:n[1]||(n[1]=e=>{l.value=!1,b.value++})},null,8,["is-open"]),c(s(_),{lines:"full"},{default:k((()=>[c(s(R),null,{default:k((()=>[x(" Allgemeines ")])),_:1}),c(s(V),null,{default:k((()=>[c(s(u),{slot:"start",icon:s(W)},null,8,["icon"]),s(o).company?(a(),t(ae,{key:0})):F("",!0),c(te,{modelValue:s(o).company,"onUpdate:modelValue":n[2]||(n[2]=e=>s(o).company=e),"input-id":"ra_company",label:"Ausführende Firma"},null,8,["modelValue"])])),_:1}),c(s(V),null,{default:k((()=>[c(s(u),{slot:"start",icon:s(M)},null,8,["icon"]),s(o).jobDescr?(a(),t(ae,{key:0})):F("",!0),c(le,{label:"Beschreibung der Tätigkeit","input-id":"ra_jobdescr",modelValue:s(o).jobDescr,"onUpdate:modelValue":n[3]||(n[3]=e=>s(o).jobDescr=e)},null,8,["modelValue"])])),_:1}),c(s(V),null,{default:k((()=>[c(s(u),{slot:"start",icon:s(T)},null,8,["icon"]),s(o).address?(a(),t(ae,{key:0})):F("",!0),c(s(m),{"router-link":y+"/location",label:"Addresse","label-placement":"floating",readonly:"",value:s(o).address},null,8,["router-link","value"])])),_:1}),c(s(V),null,{default:k((()=>[c(s(u),{slot:"start",icon:s(B)},null,8,["icon"]),s(o).startDate?(a(),t(ae,{key:0})):F("",!0),c(s(m),{"router-link":y+"/date",label:"Datum","label-placement":"floating",readonly:"",value:s(o).startDate+(s(o).endDate?" - "+s(o).endDate:"")},null,8,["router-link","value"])])),_:1}),c(s(V),{"router-link":y+"/equipment",detail:!1},{default:k((()=>[c(s(u),{slot:"start",icon:s(H)},null,8,["icon"]),s(o).equipment?(a(),t(ae,{key:0})):F("",!0),c(s(j),{position:"stacked",style:{"z-index":"10"},class:"label"},{default:k((()=>[x("Ausrüstung")])),_:1}),f.value.length>0?(a(),r("ul",ie,[(a(!0),r(h,null,v(f.value,(e=>(a(),r("li",ue,w(e.descr),1)))),256))])):F("",!0)])),_:1},8,["router-link"]),c(s(V),{"router-link":y+"/technicians",detail:!1},{default:k((()=>[c(s(u),{slot:"start",icon:s(L)},null,8,["icon"]),s(o).technicians.length>0?(a(),t(ae,{key:0})):F("",!0),c(s(j),{position:"stacked",style:{"z-index":"10"},class:"label"},{default:k((()=>[x("Personal")])),_:1}),s(o).technicians.length>0?(a(),r("ul",oe,[(a(!0),r(h,null,v(g.value,(e=>(a(),r("li",de,w(e.name),1)))),256))])):(a(),r(h,{key:2},[x(" Es wurde noch kein Personal ausgewählt ")],64))])),_:1},8,["router-link"]),c(s(R),null,{default:k((()=>[x(" Zugang ")])),_:1}),c(s(V),{"router-link":y+"/access",detail:!1},{default:k((()=>[c(s(u),{slot:"start",icon:s(U)},null,8,["icon"]),s(o).access.length>0?(a(),t(ae,{key:0})):F("",!0),c(s(j),{position:"stacked",style:{"z-index":"10"},class:"label"},{default:k((()=>[x("Sektoren")])),_:1}),0===s(o).access.length?(a(),r(h,{key:1},[x("Es wurden noch keine Sektoren definiert")],64)):1===s(o).access.length?(a(),r(h,{key:2},[x("Es wurde ein Sektor definiert")],64)):(a(),r(h,{key:3},[x("Es wurden bisher "+w(s(o).access.length)+" Sektoren definiert",1)],64))])),_:1},8,["router-link"]),c(s(V),{"router-link":y+"/rescue",detail:!1},{default:k((()=>[c(s(u),{slot:"start",icon:s($)},null,8,["icon"]),s(o).access.length>0?(a(),t(ae,{key:0})):F("",!0),c(s(j),{position:"stacked",style:{"z-index":"10"},class:"label"},{default:k((()=>[x("Rettungskonzept")])),_:1}),0===s(o).access.length?(a(),r(h,{key:1},[x("Es wurden noch keine Sektoren definiert")],64)):(a(),r(h,{key:2},[x("Für "+w(s(o).access.filter((e=>e.rescue)).length)+" Sektoren existiert ein Rettungskonzept",1)],64))])),_:1},8,["router-link"]),c(s(R),null,{default:k((()=>[x(" Gefährdungen ")])),_:1}),c(s(V),{"router-link":y+"/risks",detail:!1},{default:k((()=>[c(s(u),{slot:"start",icon:s(K)},null,8,["icon"]),s(o).access.length>0?(a(),t(ae,{key:0})):F("",!0),c(s(j),{position:"stacked",style:{"z-index":"10"},class:"label"},{default:k((()=>[x("Gefährdungen")])),_:1}),0===C.all?(a(),r(h,{key:1},[x("Es wurden noch keine Gefährdungen hinzugefügt")],64)):(a(),r(h,{key:2},[x(" Von insgesamt "+w(C.all)+" Gefährdungen sind für "+w(C.solved)+" Maßnahmen angegeben. ",1)],64))])),_:1},8,["router-link"])])),_:1})])),_:1}))}}),[["__scopeId","data-v-b50c37a5"]]))}}}));
