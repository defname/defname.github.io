System.register(["./index-legacy-sS6aLOVw.js","./database-legacy-zPeqZLiu.js","./riskassessment-legacy-obaEtDzR.js","./livequery-legacy-hzDUtCPS.js","./TemplateMainPage.vue_vue_type_script_setup_true_lang-legacy-2Hnx6-ja.js","./helpers-legacy-jVuaT5b9.js","./liveriskstree-legacy-L2MofBxz.js"],(function(e,t){"use strict";var n,s,i,l,r,a,o,d,u,c,g,f,h,k,m,_,b,p,v,y,w,D,C,j,x,z,E,T,A,B,S,L,M,F,K,$,q,G,I,P,R,V,Z,H,J,N,O;return{setters:[e=>{n=e.d,s=e.Q,i=e.o,l=e.c,r=e.w,a=e.b,o=e.f,d=e.m,u=e.n,c=e.p,g=e.q,f=e.g,h=e.R,k=e.F,m=e.G,_=e.H,b=e.J,p=e.t,v=e.j,y=e.T,w=e.K,D=e.r,C=e.U,j=e.l,x=e.V,z=e.W,E=e.X,T=e.k,A=e.Y,B=e.Z,S=e.O,L=e.I,M=e.$,F=e.a0,K=e.a1,$=e.a2,q=e.a3,G=e.a4,I=e.a5,P=e.i,R=e.a6},e=>{V=e.d},e=>{Z=e.u,H=e.d},e=>{J=e.l},e=>{N=e._},e=>{O=e.a},null],execute:function(){e("default",n({__name:"RiskAssessmentListPage",setup(e){s();const t=J.table("riskassessmentsmeta").entries(),n=Z();function Q(e){if(void 0!==n.id)return V.riskassessmentsmeta.update(n.id,{descr:e[0]})}return(e,s)=>(i(),l(N,null,{default:r((()=>[a(o(g),{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:r((()=>[a(o(d),{onClick:s[0]||(s[0]=e=>{V.riskassessments.add({...H}).then((e=>{const t=Math.floor(Date.now()/1e3);V.riskassessmentsmeta.add({id:e,descr:"Neue Gefährdungsbeurteilung "+e,created:t,lastChange:t}).then((()=>{}))}))})},{default:r((()=>[a(o(u),{icon:o(c)},null,8,["icon"])])),_:1})])),_:1}),(i(!0),f(k,null,h(o(t),(e=>(i(),l(o(m),{key:e.id},{default:r((()=>[a(o(_),{onClick:t=>{return s=e.id,n.id,void(void 0!==n.id&&s!==n.id&&n.modified()?O("In der geöffneten Einsatzplanung gibt es noch ungespeicherte Änderungen. Diese gehen verloren wenn eine andere geöffnet wird. Soll die Einsatzplanung trotzdem geöffnet werden?",{text:"Öffnen",role:"submit",icon:R,handler:()=>{n.loadFromDb(s)}}):n.loadFromDb(s));var s}},{default:r((()=>[a(o(b),null,{default:r((()=>[v(p(e.descr),1)])),_:2},1024),a(o(y),null,{default:r((()=>[v("Zuletzt geändert: "+p(new Date(1e3*e.lastChange).toLocaleString("de")),1)])),_:2},1024)])),_:2},1032,["onClick"]),e.id===o(n).id?(i(),l(o(w),{key:0,class:"ion-no-padding"},{default:r((()=>[o(n).company?(i(),l(o(D),{key:0,lines:"none"},{default:r((()=>[a(o(u),{slot:"start",icon:o(C)},null,8,["icon"]),v(" "+p(o(n).company),1)])),_:1})):j("",!0),o(n).jobDescr?(i(),l(o(D),{key:1,lines:"none"},{default:r((()=>[a(o(u),{slot:"start",icon:o(x)},null,8,["icon"]),v(" "+p(o(n).jobDescr),1)])),_:1})):j("",!0),o(n).address?(i(),l(o(D),{key:2,lines:"none"},{default:r((()=>[a(o(u),{slot:"start",icon:o(z)},null,8,["icon"]),v(" "+p(o(n).address),1)])),_:1})):j("",!0),o(n).startDate?(i(),l(o(D),{key:3,lines:"none"},{default:r((()=>[a(o(u),{slot:"start",icon:o(E)},null,8,["icon"]),v(" "+p(o(n).startDate+(o(n).endDate?" - "+o(n).endDate:"")),1)])),_:1})):j("",!0),a(o(D),{lines:"none"},{default:r((()=>[a(o(T),{fill:"clear","router-link":`/riskassessment/${e.id}`},{default:r((()=>[v("Bearbeiten")])),_:2},1032,["router-link"]),a(o(T),{fill:"clear",slot:"end",id:"popoverTrigger"+e.id},{default:r((()=>[a(o(u),{icon:o(A)},null,8,["icon"])])),_:2},1032,["id"]),a(o(B),{trigger:"popoverTrigger"+e.id,"dismiss-on-select":""},{default:r((()=>[a(o(S),null,{default:r((()=>[a(o(L),{lines:"none"},{default:r((()=>[a(o(D),{id:"titleChangeTrigger"+e.id,button:""},{default:r((()=>[a(o(u),{icon:o(M),slot:"start"},null,8,["icon"]),v(" Beschreibung ändern "),a(o(F),{trigger:"titleChangeTrigger"+e.id,header:"Beschreibung eingeben",buttons:["Abbrechen",{text:"Speichern",handler:Q}],inputs:[{placeholder:"Beschreibung",value:e.descr}]},null,8,["trigger","buttons","inputs"])])),_:2},1032,["id"]),a(o(D),{"router-link":`/riskassessment/${e.id}/export`,button:""},{default:r((()=>[a(o(u),{icon:o(K),slot:"start"},null,8,["icon"]),v(" Exportieren ")])),_:2},1032,["router-link"]),a(o(D),{button:""},{default:r((()=>[a(o(u),{icon:o($),slot:"start"},null,8,["icon"]),v(" Als Vorlage speichern ")])),_:1}),a(o(D),{button:"",onClick:t=>async function(e){return V.riskassessments.get(e).then((t=>{if(void 0===t)throw Error("riskassessment "+e+" canno be duplicated, since it does not exist in the database");return delete t.id,V.riskassessments.add(t)})).then((t=>V.riskassessmentsmeta.get(e).then((n=>{if(void 0===n)throw Error("riskassessmentMeta for riskassessment "+e+" not found in database.");const s=Math.floor(Date.now()/1e3);return V.riskassessmentsmeta.add({id:t,descr:"Kopie von "+n.descr,created:s,lastChange:s})}))))}(e.id)},{default:r((()=>[a(o(u),{icon:o(q),slot:"start"},null,8,["icon"]),v(" Duplizieren ")])),_:2},1032,["onClick"]),a(o(D),{button:""},{default:r((()=>[a(o(u),{icon:o(G),slot:"start"},null,8,["icon"]),v(" Archivieren ")])),_:1}),a(o(D),{onClick:t=>{return n=e.id,void O("Soll der Einsatzplan wirklich unwideruflich gelöscht werden?",{text:"Löschen",icon:I,handler:()=>{J.table("riskassessments").delete(n),J.table("riskassessmentsmeta").delete(n)}});var n},button:""},{default:r((()=>[a(o(u),{icon:o(I),slot:"start",color:"danger"},null,8,["icon"]),a(o(P),{color:"danger"},{default:r((()=>[v("Löschen")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["trigger"])])),_:2},1024)])),_:2},1024)):j("",!0)])),_:2},1024)))),128))])),_:1}))}}))}}}));
