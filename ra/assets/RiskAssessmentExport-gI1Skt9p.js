import{d as x,x as A,aj as z,o as t,c as G,w as h,b as _,j as i,f as s,k as y,H as I,J as R,K as $,a as n,t as o,g as l,l as g,R as p,F as a,G as B}from"./index-moZKpHyX.js";import{b as D,u as F}from"./riskassessment-SQJpM6Cc.js";import{G as S}from"./GenericEditModal-y7kKvbZT.js";import{S as b}from"./helpers-RUszpi03.js";import{T as V}from"./TemplateRiskAssessmentPage-4adekKqQ.js";import{S as N}from"./SignatureInput-iQj6J5dg.js";import"./livequery-oYSwY8HK.js";import"./liveriskstree-Trw7157v.js";import"./index-nCdY6HSE.js";function P(T){const{exportData:v,updateExportData:r}=D(T);return pdfMake.tableLayouts={customLayout:{hLineWidth:function(c,m){return c===0||c===m.table.body.length?0:c===m.table.headerRows?.5:0},vLineWidth:function(c){return 0},hLineColor:function(c){return"#aaa"},paddingLeft:function(c){return c===0?0:8},paddingRight:function(c,m){return c===m.table.widths.length-1?0:8}},riskTable:{hLineWidth:()=>.5,vLineWidth:()=>.5,hLineColor:()=>"#aaa",vLineColor:()=>"#aaa"}},{open:async()=>{await r(),console.log("FOOO")}}}const W={id:"print"},j=n("h1",null,"Einsatzplanung",-1),O=n("p",null," Es wird grundsätzlich nach den geltenden Regeln und Vorschriften der DGUV, dem Arbeitsschutzgesetz, der BetrSichV, den TRBS und der FISAT FSR-SZP gearbeitet. ",-1),U=n("strong",null,"Ausführende Firma:",-1),Z=n("strong",null,"Einsatzdatum:",-1),q=n("strong",null,"Einsatzort:",-1),J=n("strong",null,"Durchzuführende Arbeiten:",-1),K=n("br",null,null,-1),Q={key:0},X=n("strong",null,"Aufsichtsführende Höhenarbeiter:",-1),Y=n("p",null,[n("strong",null,"Höhenarbeiter:")],-1),nn=n("thead",null,[n("tr",null,[n("th",null,"Name"),n("th",null,"FISAT-Nr"),n("th",null,"Level")])],-1),en=n("strong",null,"Ausrüstung:",-1),tn=n("h2",null,"Zugangsverfahren",-1),sn={key:0},ln=n("strong",null,"Einstieg:",-1),rn=["innerHTML"],un={key:1},on=n("strong",null,"Ausstieg:",-1),an=["innerHTML"],dn={key:2},cn=n("strong",null,"Anschlagpunkte:",-1),hn=["innerHTML"],_n=["innerHTML"],pn=n("h2",null,"Notfall- und Rettungsplan",-1),gn=["innerHTML"],mn=n("h1",null,"Gefährdungsermittlung",-1),fn={key:0},kn={key:1},bn={key:2},yn=n("thead",null,[n("tr",null,[n("th",null,"Gefährdung"),n("th",null,"Maßnahme")])],-1),vn={colspan:"2"},Ln={class:"factor"},En={key:0},Tn=["src"],An={key:2},Dn=n("strong",null,"Ohne Unterschrift",-1),Cn=[Dn],Hn=n("h1",null,"Empfangsbestätigung",-1),Mn=n("p",null," Es wird bestätigt, über Gefahren und Maßnahmen aufgeklärt worden zu sein. ",-1),wn=["src"],Vn=x({__name:"RiskAssessmentExport",setup(T){const v=F(),{exportData:r,updateExportData:L}=D(),{open:c}=P(),m=A(void 0),E=A(!1);function C(k){const u=window.open("","print","");if(!u)return;u.open(),u.document.write('<html>\n    <head>\n        <link rel="stylesheet" href="/ra/print.css" />\n    </head>\n    <body>'.concat(k.outerHTML,"\n    </body>\n    </html>")),u.document.close();const e=u.document.createElement("script");e.setAttribute("src","/ra/print.js"),u.document.head.appendChild(e)}async function H(){C(document.getElementById("print"))}function M(k){v.signature=k,L()}return z(()=>{L()}),(k,u)=>(t(),G(V,null,{default:h(()=>[_(s(y),{"router-link":"/riskassessment/"+s(v).id+"/sign"},{default:h(()=>[i("Unterzeichnen (Technicker)")]),_:1},8,["router-link"]),_(s(y),{onClick:u[0]||(u[0]=e=>E.value=!0)},{default:h(()=>[i("Unterzeichnen")]),_:1}),_(s(y),{onClick:u[1]||(u[1]=e=>H())},{default:h(()=>[i("Drucken")]),_:1}),_(s(y),{onClick:u[2]||(u[2]=e=>s(c)())},{default:h(()=>[i("PDF")]),_:1}),_(S,{"is-open":E.value,"hide-save":"",onWillDismiss:u[3]||(u[3]=e=>E.value=!1),onDidPresent:u[4]||(u[4]=e=>k.$refs.signatureinput.updateDimensions())},{default:h(()=>[_(N,{onSignature:M,ref_key:"signatureinput",ref:m},null,512)]),_:1},8,["is-open"]),_(s(B),null,{default:h(()=>[_(s(I),null,{default:h(()=>[_(s(R),null,{default:h(()=>[i("Druckvorschau")]),_:1})]),_:1}),_(s($),null,{default:h(()=>[n("div",W,[j,O,n("p",null,[U,i(" "+o(s(r).company),1)]),n("p",null,[Z,i(" "+o(s(r).startDate)+" "+o(s(r).endDate?s(r).endDate:""),1)]),n("p",null,[q,i(" "+o(s(r).address),1)]),n("p",null,[J,K,i(" "+o(s(r).jobDescr),1)]),s(r).supervisors?(t(),l("p",Q,[X,i(" "+o(s(r).supervisors.map(e=>e.name).join(", ")),1)])):g("",!0),Y,n("table",null,[nn,(t(!0),l(a,null,p(s(r).technicians,e=>{var f,d;return t(),l("tr",null,[n("td",null,o(e.name),1),n("td",null,o((f=e.fisat)==null?void 0:f.id),1),n("td",null,o((d=e.fisat)==null?void 0:d.level),1)])}),256))]),n("p",null,[en,n("ul",null,[(t(!0),l(a,null,p(s(r).equipment,e=>(t(),l("li",null,o(e.descr),1))),256))])]),tn,(t(!0),l(a,null,p(s(r).access,e=>(t(),l(a,null,[n("p",null,[n("strong",null,o(e.title),1)]),e.access?(t(),l("p",sn,[ln,i(),n("span",{innerHTML:e.access},null,8,rn)])):g("",!0),e.exit?(t(),l("p",un,[on,i(),n("span",{innerHTML:e.exit},null,8,an)])):g("",!0),e.anchorPoints?(t(),l("p",dn,[cn,i(),n("span",{innerHTML:e.anchorPoints},null,8,hn)])):g("",!0),e.comment?(t(),l("p",{key:3,innerHTML:e.comment},null,8,_n)):g("",!0)],64))),256)),pn,(t(!0),l(a,null,p(s(r).access,e=>(t(),l(a,null,[n("p",null,[n("strong",null,o(e.title),1)]),n("p",{innerHTML:e.rescue},null,8,gn)],64))),256)),mn,(t(!0),l(a,null,p([s(b).Access,s(b).Environment,s(b).Work],e=>(t(),l(a,null,[e===s(b).Access?(t(),l("h3",fn,"Gefahren durch die ausgewählten Zugangstechniken")):e===s(b).Environment?(t(),l("h3",kn,"Gefahren durch die Arbeitsumgebung")):(t(),l("h3",bn,"Gefahren durch die Arbeit")),n("table",null,[yn,n("tbody",null,[(t(!0),l(a,null,p(s(r).categories,f=>(t(),l(a,null,[f.risks.filter(d=>d.risk.sector===e).length?(t(),l(a,{key:0},[n("tr",null,[n("th",vn,o(f.descr),1)]),(t(!0),l(a,null,p(f.risks.filter(d=>d.risk.sector===e),d=>(t(),l("tr",null,[n("td",null,[n("span",Ln,o(d.risk.factor.descr),1),i(" "+o(d.risk.descr),1)]),n("td",null,[d.measures.length>1?(t(),l("ul",En,[(t(!0),l(a,null,p(d.measures,w=>(t(),l("li",null,o(w.descr),1))),256))])):d.measures.length===1?(t(),l(a,{key:1},[i(o(d.measures[0].descr),1)],64)):g("",!0)])]))),256))],64)):g("",!0)],64))),256))])])],64))),256)),s(r).signature?(t(),l("img",{key:1,src:s(r).signature.signature},null,8,Tn)):(t(),l("p",An,Cn)),Hn,Mn,(t(!0),l(a,null,p(s(r).signatures,e=>(t(),l("div",null,[n("img",{src:e.signature},null,8,wn)]))),256))])]),_:1})]),_:1})]),_:1}))}});export{Vn as default};
