System.register(["./index-legacy-oFp8G8Ab.js","./database-legacy-al1Sa8N6.js","./riskassessment-legacy-6zytJ6aS.js","./livequery-legacy-5AwHvNjI.js","./TemplateMainPage.vue_vue_type_script_setup_true_lang-legacy-s_oixmCG.js","./helpers-legacy-AWkUcU2B.js","./liveriskstree-legacy-bYbQc470.js"],(function(e,t){"use strict";var n,s,i,l,r,a,o,d,u,c,g,f,h,k,m,_,b,p,v,y,D,w,C,j,x,z,E,T,S,A,B,L,M,F,$,q,G,I,J,K,P,R,V,Z,H,N;return{setters:[e=>{n=e.d,s=e.Q,i=e.o,l=e.c,r=e.w,a=e.b,o=e.f,d=e.m,u=e.n,c=e.p,g=e.q,f=e.g,h=e.R,k=e.F,m=e.G,_=e.H,b=e.J,p=e.t,v=e.j,y=e.T,D=e.K,w=e.r,C=e.U,j=e.l,x=e.V,z=e.W,E=e.X,T=e.k,S=e.Y,A=e.Z,B=e.O,L=e.I,M=e.$,F=e.a0,$=e.a1,q=e.a2,G=e.a3,I=e.a4,J=e.i,K=e.a5},e=>{P=e.d},e=>{R=e.u,V=e.d},e=>{Z=e.l},e=>{H=e._},e=>{N=e.a},null],execute:function(){e("default",n({__name:"RiskAssessmentListPage",setup(e){s();const t=Z.table("riskassessmentsmeta").entries(),n=R();function O(e){if(void 0!==n.id)return P.riskassessmentsmeta.update(n.id,{descr:e[0]})}return(e,s)=>(i(),l(H,null,{default:r((()=>[a(o(g),{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:r((()=>[a(o(d),{onClick:s[0]||(s[0]=e=>{P.riskassessments.add({...V}).then((e=>{const t=Math.floor(Date.now()/1e3);P.riskassessmentsmeta.add({id:e,descr:"Neue Gefährdungsbeurteilung "+e,created:t,lastChange:t}).then((()=>{}))}))})},{default:r((()=>[a(o(u),{icon:o(c)},null,8,["icon"])])),_:1})])),_:1}),(i(!0),f(k,null,h(o(t),(e=>(i(),l(o(m),{key:e.id},{default:r((()=>[a(o(_),{onClick:t=>{return s=e.id,n.id,void(void 0!==n.id&&s!==n.id&&n.modified()?N("In der geöffneten Einsatzplanung gibt es noch ungespeicherte Änderungen. Diese gehen verloren wenn eine andere geöffnet wird. Soll die Einsatzplanung trotzdem geöffnet werden?",{text:"Öffnen",role:"submit",icon:K,handler:()=>{n.loadFromDb(s)}}):n.loadFromDb(s));var s}},{default:r((()=>[a(o(b),null,{default:r((()=>[v(p(e.descr),1)])),_:2},1024),a(o(y),null,{default:r((()=>[v("Zuletzt geändert: "+p(new Date(1e3*e.lastChange).toLocaleString("de")),1)])),_:2},1024)])),_:2},1032,["onClick"]),e.id===o(n).id?(i(),l(o(D),{key:0,class:"ion-no-padding"},{default:r((()=>[o(n).company?(i(),l(o(w),{key:0,lines:"none"},{default:r((()=>[a(o(u),{slot:"start",icon:o(C)},null,8,["icon"]),v(" "+p(o(n).company),1)])),_:1})):j("",!0),o(n).jobDescr?(i(),l(o(w),{key:1,lines:"none"},{default:r((()=>[a(o(u),{slot:"start",icon:o(x)},null,8,["icon"]),v(" "+p(o(n).jobDescr),1)])),_:1})):j("",!0),o(n).address?(i(),l(o(w),{key:2,lines:"none"},{default:r((()=>[a(o(u),{slot:"start",icon:o(z)},null,8,["icon"]),v(" "+p(o(n).address),1)])),_:1})):j("",!0),o(n).startDate?(i(),l(o(w),{key:3,lines:"none"},{default:r((()=>[a(o(u),{slot:"start",icon:o(E)},null,8,["icon"]),v(" "+p(o(n).startDate+(o(n).endDate?" - "+o(n).endDate:"")),1)])),_:1})):j("",!0),a(o(w),{lines:"none"},{default:r((()=>[a(o(T),{fill:"clear","router-link":`/riskassessment/${e.id}`},{default:r((()=>[v("Bearbeiten")])),_:2},1032,["router-link"]),a(o(T),{fill:"clear",slot:"end",id:"popoverTrigger"+e.id},{default:r((()=>[a(o(u),{icon:o(S)},null,8,["icon"])])),_:2},1032,["id"]),a(o(A),{trigger:"popoverTrigger"+e.id,"dismiss-on-select":""},{default:r((()=>[a(o(B),null,{default:r((()=>[a(o(L),{lines:"none"},{default:r((()=>[a(o(w),{id:"titleChangeTrigger"+e.id,button:""},{default:r((()=>[a(o(u),{icon:o(M),slot:"start"},null,8,["icon"]),v(" Beschreibung ändern "),a(o(F),{trigger:"titleChangeTrigger"+e.id,header:"Beschreibung eingeben",buttons:["Abbrechen",{text:"Speichern",handler:O}],inputs:[{placeholder:"Beschreibung",value:e.descr}]},null,8,["trigger","buttons","inputs"])])),_:2},1032,["id"]),a(o(w),{"router-link":`/riskassessment/${e.id}/export`,button:""},{default:r((()=>[a(o(u),{icon:o($),slot:"start"},null,8,["icon"]),v(" Exportieren ")])),_:2},1032,["router-link"]),a(o(w),{button:""},{default:r((()=>[a(o(u),{icon:o(q),slot:"start"},null,8,["icon"]),v(" Als Vorlage speichern ")])),_:1}),a(o(w),{button:"",onClick:t=>async function(e){return P.riskassessments.get(e).then((t=>{if(void 0===t)throw Error("riskassessment "+e+" canno be duplicated, since it does not exist in the database");return delete t.id,P.riskassessments.add(t)})).then((t=>P.riskassessmentsmeta.get(e).then((n=>{if(void 0===n)throw Error("riskassessmentMeta for riskassessment "+e+" not found in database.");const s=Math.floor(Date.now()/1e3);return P.riskassessmentsmeta.add({id:t,descr:"Kopie von "+n.descr,created:s,lastChange:s})}))))}(e.id)},{default:r((()=>[a(o(u),{icon:o(G),slot:"start"},null,8,["icon"]),v(" Duplizieren ")])),_:2},1032,["onClick"]),a(o(w),{onClick:t=>{return n=e.id,void N("Soll der Einsatzplan wirklich unwideruflich gelöscht werden?",{text:"Löschen",icon:I,handler:()=>{Z.table("riskassessments").delete(n),Z.table("riskassessmentsmeta").delete(n)}});var n},button:""},{default:r((()=>[a(o(u),{icon:o(I),slot:"start",color:"danger"},null,8,["icon"]),a(o(J),{color:"danger"},{default:r((()=>[v("Löschen")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["trigger"])])),_:2},1024)])),_:2},1024)):j("",!0)])),_:2},1024)))),128))])),_:1}))}}))}}}));
