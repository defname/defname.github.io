import{i as F,n as x,a as E,t as b,b as P}from"./index-9UN-Ox_G.js";import{x as v,e as m,al as D,b3 as L,b4 as T}from"./index-6YVP06UH.js";function B(i){var e;const n=b(i);return(e=n==null?void 0:n.$el)!=null?e:n}const _=F?window:void 0;function S(...i){let e,n,t,l;if(typeof i[0]=="string"||Array.isArray(i[0])?([n,t,l]=i,e=_):[e,n,t,l]=i,!e)return x;Array.isArray(n)||(n=[n]),Array.isArray(t)||(t=[t]);const u=[],r=()=>{u.forEach(f=>f()),u.length=0},s=(f,d,w,c)=>(f.addEventListener(d,w,c),()=>f.removeEventListener(d,w,c)),p=D(()=>[B(e),b(l)],([f,d])=>{if(r(),!f)return;const w=E(d)?{...d}:d;u.push(...n.flatMap(c=>t.map(k=>s(f,c,k,w))))},{immediate:!0,flush:"post"}),y=()=>{p(),r()};return P(y),y}function N(){const i=v(!1);return L()&&T(()=>{i.value=!0}),i}function M(i){const e=N();return m(()=>(e.value,!!i()))}function j(i={}){const{window:e=_,dataType:n="Text"}=i,t=e,l=M(()=>t&&"showSaveFilePicker"in t&&"showOpenFilePicker"in t),u=v(),r=v(),s=v(),p=m(()=>{var a,o;return(o=(a=s.value)==null?void 0:a.name)!=null?o:""}),y=m(()=>{var a,o;return(o=(a=s.value)==null?void 0:a.type)!=null?o:""}),f=m(()=>{var a,o;return(o=(a=s.value)==null?void 0:a.size)!=null?o:0}),d=m(()=>{var a,o;return(o=(a=s.value)==null?void 0:a.lastModified)!=null?o:0});async function w(a={}){if(!l.value)return;const[o]=await t.showOpenFilePicker({...b(i),...a});u.value=o,await h(),await O()}async function c(a={}){l.value&&(u.value=await t.showSaveFilePicker({...i,...a}),r.value=void 0,await h(),await O())}async function k(a={}){if(l.value){if(!u.value)return g(a);if(r.value){const o=await u.value.createWritable();await o.write(r.value),await o.close()}await h()}}async function g(a={}){if(l.value){if(u.value=await t.showSaveFilePicker({...i,...a}),r.value){const o=await u.value.createWritable();await o.write(r.value),await o.close()}await h()}}async function h(){var a;s.value=await((a=u.value)==null?void 0:a.getFile())}async function O(){var a,o;const A=b(n);A==="Text"?r.value=await((a=s.value)==null?void 0:a.text()):A==="ArrayBuffer"?r.value=await((o=s.value)==null?void 0:o.arrayBuffer()):A==="Blob"&&(r.value=s.value)}return D(()=>b(n),O),{isSupported:l,data:r,file:s,fileName:p,fileMIME:y,fileSize:f,fileLastModified:d,open:w,create:c,save:k,saveAs:g,updateData:O}}function W(i={}){const{window:e=_}=i,n=e==null?void 0:e.navigator,t=M(()=>n&&"connection"in n),l=v(!0),u=v(!1),r=v(void 0),s=v(void 0),p=v(void 0),y=v(void 0),f=v(void 0),d=v(void 0),w=v("unknown"),c=t.value&&n.connection;function k(){n&&(l.value=n.onLine,r.value=l.value?void 0:Date.now(),s.value=l.value?Date.now():void 0,c&&(p.value=c.downlink,y.value=c.downlinkMax,d.value=c.effectiveType,f.value=c.rtt,u.value=c.saveData,w.value=c.type))}return e&&(S(e,"offline",()=>{l.value=!1,r.value=Date.now()}),S(e,"online",()=>{l.value=!0,s.value=Date.now()})),c&&S(c,"change",k,!1),k(),{isSupported:t,isOnline:l,saveData:u,offlineAt:r,onlineAt:s,downlink:p,downlinkMax:y,effectiveType:d,rtt:f,type:w}}function z(i={}){const{isOnline:e}=W(i);return e}function H(i={}){const{window:e=_}=i,n=M(()=>e&&"screen"in e&&"orientation"in e.screen),t=n.value?e.screen.orientation:{},l=v(t.type),u=v(t.angle||0);return n.value&&S(e,"orientationchange",()=>{l.value=t.type,u.value=t.angle}),{isSupported:n,orientation:l,angle:u,lockOrientation:p=>n.value&&typeof t.lock=="function"?t.lock(p):Promise.reject(new Error("Not supported")),unlockOrientation:()=>{n.value&&typeof t.unlock=="function"&&t.unlock()}}}export{H as a,j as b,z as u};
